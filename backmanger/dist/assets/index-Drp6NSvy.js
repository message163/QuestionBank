import{a as U,d as E,r as y,b as z,c as p,o as T,e as A,f as e,w as a,g as V,h as b,F as G,E as S,p as H,i as J,_ as D,j as K,k as M,l as v,m as Q,u as f,s as X,n as Y,t as Z,q as $}from"./index-C7bYiLws.js";const ee=async u=>(await U.post("/api/course/create",u)).data,le=async u=>(await U.get("/api/course/list",{params:u})).data,te=async u=>(await U.patch(`/api/course/update/${u._id}`,u)).data,ae=async u=>(await U.delete(`/api/course/delete/${u._id}`)).data,oe="/fs/course/upload/excel",re=u=>(H("data-v-1f53592a"),u=u(),J(),u),se=re(()=>V("h3",{class:"title"},"课程目录",-1)),ne={class:"form-btns"},ue=E({__name:"create",emits:["on-submit"],setup(u,{expose:h,emit:w}){const x=w,c=y(),t=z({stage:0,semester:0,unit:0,chapter:0,courseId:0,courseNumberd:0,courseName:"",author:"",courseCategories:"",lessonType:"",writingStyle:"",languageStyle:"",showpopover:!1,_id:""}),C=z({stage:[{type:"number",required:!0,message:"请输入阶段",trigger:"change"},{type:"number",message:"请输入阶段",trigger:"blur"}],semester:[{type:"number",required:!0,message:"请输入学期",trigger:"change"},{type:"number",message:"请输入学期",trigger:"blur"}],unit:[{type:"number",required:!0,message:"请输入单元",trigger:"change"},{type:"number",message:"请输入单元",trigger:"blur"}],chapter:[{type:"number",required:!0,message:"请输入章节",trigger:"change"},{type:"number",message:"请输入章节",trigger:"blur"}],courseId:[{type:"number",required:!0,message:"请输入课程编号",trigger:"change"},{type:"number",message:"请输入课程编号",trigger:"blur"}],courseNumberd:[{type:"number",required:!0,message:"请输入课号",trigger:"change"},{type:"number",message:"请输入课号",trigger:"blur"}],courseName:[{required:!0,message:"请输入课程名称",trigger:"change"},{message:"请输入课程名称",trigger:"blur"}],author:[{required:!0,message:"请输入课程作者",trigger:"change"},{message:"请输入课程作者",trigger:"blur"}],courseCategories:[{required:!0,message:"请输入课程分类",trigger:"change"},{message:"请输入课程分类",trigger:"blur"}],lessonType:[{required:!0,message:"请输入课程类型",trigger:"change"},{message:"请输入课程类型",trigger:"blur"}],writingStyle:[{required:!0,message:"请输入文体",trigger:"change"},{message:"请输入文体",trigger:"blur"}],languageStyle:[{required:!0,message:"请输入语体",trigger:"change"},{message:"请输入语体",trigger:"blur"}]}),g=async()=>{var m;(m=c.value)==null||m.validate(async o=>{if(o){t._id||Reflect.deleteProperty(t,"_id");const r=await(t._id?te(t):ee(t));(r==null?void 0:r.code)==200?(S.success(r.message),x("on-submit"),k()):S.error((r==null?void 0:r.message)||"提交失败")}})},q=m=>{Object.assign(t,m)},k=()=>{var m;(m=c.value)==null||m.resetFields(),t._id=""};return h({onSubmit:g,onReset:k,onUpdateForm:q}),(m,o)=>{const r=p("el-input"),n=p("el-form-item"),N=p("el-button"),s=p("el-form");return T(),A(G,null,[se,e(s,{ref_key:"formEl",ref:c,class:"form",model:t,rules:C,"label-width":"auto"},{default:a(()=>[e(n,{prop:"stage",label:"阶段："},{default:a(()=>[e(r,{type:"number",placeholder:"请输入阶段",modelValue:t.stage,"onUpdate:modelValue":o[0]||(o[0]=l=>t.stage=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(n,{prop:"semester",label:"学期："},{default:a(()=>[e(r,{type:"number",placeholder:"请输入学期",modelValue:t.semester,"onUpdate:modelValue":o[1]||(o[1]=l=>t.semester=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(n,{prop:"unit",label:"单元："},{default:a(()=>[e(r,{type:"number",placeholder:"请输入单元",modelValue:t.unit,"onUpdate:modelValue":o[2]||(o[2]=l=>t.unit=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(n,{prop:"chapter",label:"章节："},{default:a(()=>[e(r,{type:"number",placeholder:"请输入章节",modelValue:t.chapter,"onUpdate:modelValue":o[3]||(o[3]=l=>t.chapter=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(n,{prop:"courseId",label:"课程编号："},{default:a(()=>[e(r,{type:"number",placeholder:"请输入课程编号",modelValue:t.courseId,"onUpdate:modelValue":o[4]||(o[4]=l=>t.courseId=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(n,{prop:"courseNumberd",label:"课号："},{default:a(()=>[e(r,{type:"number",placeholder:"请输入课号",modelValue:t.courseNumberd,"onUpdate:modelValue":o[5]||(o[5]=l=>t.courseNumberd=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(n,{prop:"courseName",label:"课程名称："},{default:a(()=>[e(r,{placeholder:"请输入课程名称",modelValue:t.courseName,"onUpdate:modelValue":o[6]||(o[6]=l=>t.courseName=l)},null,8,["modelValue"])]),_:1}),e(n,{prop:"author",label:"课程作者："},{default:a(()=>[e(r,{placeholder:"请输入课程作者",modelValue:t.author,"onUpdate:modelValue":o[7]||(o[7]=l=>t.author=l)},null,8,["modelValue"])]),_:1}),e(n,{prop:"courseCategories",label:"课程分类："},{default:a(()=>[e(r,{placeholder:"请输入课程分类",modelValue:t.courseCategories,"onUpdate:modelValue":o[8]||(o[8]=l=>t.courseCategories=l)},null,8,["modelValue"])]),_:1}),e(n,{prop:"lessonType",label:"课程类型："},{default:a(()=>[e(r,{placeholder:"请输入课程类型",modelValue:t.lessonType,"onUpdate:modelValue":o[9]||(o[9]=l=>t.lessonType=l)},null,8,["modelValue"])]),_:1}),e(n,{prop:"writingStyle",label:"文体："},{default:a(()=>[e(r,{placeholder:"请输入文体",modelValue:t.writingStyle,"onUpdate:modelValue":o[10]||(o[10]=l=>t.writingStyle=l)},null,8,["modelValue"])]),_:1}),e(n,{prop:"languageStyle",label:"语体："},{default:a(()=>[e(r,{placeholder:"请输入语体",modelValue:t.languageStyle,"onUpdate:modelValue":o[11]||(o[11]=l=>t.languageStyle=l)},null,8,["modelValue"])]),_:1}),e(n,null,{default:a(()=>[V("div",ne,[e(N,{type:"primary",onClick:g},{default:a(()=>[b("提交")]),_:1}),e(N,{onClick:k},{default:a(()=>[b("重置")]),_:1})])]),_:1})]),_:1},8,["model","rules"])],64)}}}),de=D(ue,[["__scopeId","data-v-1f53592a"]]),ie={class:"course-header"},pe={class:"course-header-btn"},me={style:{"margin-top":"10px"}},ce=E({__name:"index",setup(u){const h=y(!1),w=y("");let x=y([]);const c=y(!1),t=y(0),C=y(),g=async()=>{h.value=!0;const s=await le({...v,keyWord:w.value});s.data.data.forEach(l=>{l.showpopover=!1}),x.value=s.data.data,t.value=s.data.total,h.value=!1},q=s=>{v.pageNo=s,g()},k=async()=>{var s;c.value=!0,await $(),(s=C.value)==null||s.onReset()},m=async s=>{const l=await ae({_id:s._id});s.showpopover=!1,l.code==200?(S.success(l.message),g()):S.error(l.message)},o=async s=>{var l;c.value=!0,await $(),(l=C.value)==null||l.onUpdateForm(s)},r=()=>{c.value=!1,g()},n=()=>{g()},N=()=>{S.success("导入成功"),g()};return K(()=>{g()}),(s,l)=>{const _=p("el-button"),F=p("el-input"),B=p("el-upload"),i=p("el-table-column"),j=p("el-popover"),L=p("el-table"),R=p("el-pagination"),O=p("el-dialog"),P=p("el-card"),W=Q("loading");return T(),M(P,null,{default:a(()=>[V("div",ie,[e(F,{clearable:"",modelValue:w.value,"onUpdate:modelValue":l[0]||(l[0]=d=>w.value=d),modelModifiers:{trim:!0},style:{"max-width":"600px"},placeholder:"请输入课程名称进行查询..."},{append:a(()=>[e(_,{onClick:n,icon:f(X)},null,8,["icon"])]),_:1},8,["modelValue"]),V("div",pe,[e(_,{onClick:k,type:"primary"},{default:a(()=>[b("新建")]),_:1}),e(B,{"on-success":N,name:"file",method:"post",action:f(oe),accept:".xlsx","show-file-list":!1},{default:a(()=>[e(_,{type:"success"},{default:a(()=>[b("导入")]),_:1})]),_:1},8,["action"])])]),Y((T(),M(L,{"element-loading-text":"Loading...",data:f(x),"empty-text":"暂无数据",border:""},{default:a(()=>[e(i,{align:"center",prop:"stage",label:"阶段"}),e(i,{align:"center",prop:"semester",label:"学期"}),e(i,{align:"center",prop:"unit",label:"单元"}),e(i,{align:"center",prop:"chapter",label:"章节"}),e(i,{align:"center",prop:"courseId",label:"课程编号"}),e(i,{align:"center",prop:"courseNumberd",label:"课号"}),e(i,{align:"center",prop:"courseName",label:"课程名称"}),e(i,{align:"center",prop:"author",label:"课程作者"}),e(i,{align:"center",prop:"courseCategories",label:"课程分类"}),e(i,{align:"center",prop:"lessonType",label:"课程类型"}),e(i,{align:"center",prop:"writingStyle",label:"文体"}),e(i,{align:"center",prop:"languageStyle",label:"语体"}),e(i,{width:"150px",align:"center",label:"操作"},{default:a(d=>[e(_,{size:"small",type:"primary",onClick:I=>o(d.row)},{default:a(()=>[b("编辑")]),_:2},1032,["onClick"]),e(j,{visible:d.row.showpopover,trigger:"click",placement:"bottom",width:160},{reference:a(()=>[e(_,{onClick:I=>d.row.showpopover=!0,size:"small",type:"danger"},{default:a(()=>[b("删除")]),_:2},1032,["onClick"])]),default:a(()=>[V("p",null,"是否删除"+Z(d.row.courseName),1),V("div",me,[e(_,{onClick:I=>d.row.showpopover=!1,type:"primary",size:"small"},{default:a(()=>[b("取消")]),_:2},1032,["onClick"]),e(_,{type:"danger",size:"small",onClick:I=>m(d.row)},{default:a(()=>[b(" 确定 ")]),_:2},1032,["onClick"])])]),_:2},1032,["visible"])]),_:1})]),_:1},8,["data"])),[[W,h.value]]),e(R,{onCurrentChange:q,"current-page":f(v).pageNo,"onUpdate:currentPage":l[1]||(l[1]=d=>f(v).pageNo=d),"page-size":f(v).pageSize,"onUpdate:pageSize":l[2]||(l[2]=d=>f(v).pageSize=d),background:"",layout:"prev, pager, next, jumper, ->, total",total:t.value},null,8,["current-page","page-size","total"]),e(O,{top:"7vh",modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=d=>c.value=d)},{default:a(()=>[e(de,{onOnSubmit:r,ref_key:"dataTemp",ref:C},null,512)]),_:1},8,["modelValue"])]),_:1})}}}),be=D(ce,[["__scopeId","data-v-4f176a8c"]]);export{be as default};
